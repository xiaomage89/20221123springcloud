function beforeGetbounds(){try{if(!window.disablePanel){var o=window["widgetFloat_jsons"];if(o){var b=g_rptpage.getWidgets();for(var g=0;g<o.length;g++){var s=o[g];if(!s||!s.id){continue;}var f=s.id;if(b[f]){b[f].setContentVisible(false);b[f].icon.style.display="none";}}}window.disablePanel=true;}var d;var p=false;if(window.g_rptpage){d=window.g_rptpage.getBodyArea();}else{if(window.g_dsn){if($(".gridselectgrag")&&$(".gridselectgrag").length>0){$(".gridselectgrag").each(function(e,i){i.style.display="none";});}d=window.document.body;}else{if(window.g_coolpage){d=window.g_coolpage.doc.body.children[0];p=true;}else{return;}}}var j=d.scrollWidth;var q=d.scrollHeight;var m=d.clientWidth;var a=d.clientHeight;var c=document.body.clientWidth;var l=document.body.clientHeight;var r=c-m;var n=l-a;if(r>10){q+=r;}if(n>10){j+=n;}q+=50;if(window.g_dsn){var h=window.g_dsn.getEditorDom().firstChild;if(h){j+=h.scrollWidth-h.clientWidth;q+=h.scrollHeight-h.clientHeight;}}window.callPhantom("resizeWindow",j+"",q+"",p);}catch(k){alert(k);}}function resizeWindow(){var c=arguments[0];var b=arguments[1];var a=arguments[2]||false;if(a){page.viewportSize={width:parseInt(c),height:parseInt(b)};page.clipRect={top:0,left:0,width:(parseInt(c)+5)>10000?10000:(parseInt(c)+5),height:parseInt(b)>10000?10000:parseInt(b)};}else{page.viewportSize={width:parseInt(c),height:parseInt(b)+9};page.clipRect={top:9,left:0,width:(parseInt(c)+5)>10000?10000:(parseInt(c)+5),height:parseInt(b)>10000?10000:parseInt(b)};}}function getBounds_EBI(){try{var a=arguments[0].toString();var d=window.document.getElementById(a);if(!d){alert("");}var c=d.getBoundingClientRect();var b=[c.top-2,c.left-2,d.offsetWidth+2,d.offsetHeight+40];window.callPhantom("getBounds_CallBack",b.toString());}catch(f){alert(f);}}function toNextPage_EBI(){try{var i=arguments[0].toString();var m=false;var b=window.g_rptid;if(window.g_rptpage){var k=window.g_rptpage.getGrids();var n=document.getElementById("tr_rptPageIndex");var q;if(n&&n.style.display!="none"){q=window.g_rptpage.pagebar;var r=q.paramobj.pageIndex;var h=q.paramobj.pageCount;var p=window.g_rptpage.calcInfo["thisPageSize"];var d;for(var c in k){d=c;}var g=window.g_rptpage.getGrids()[d].griddom.style.display;if(g!="none"){if(i==="true"){r=0;m=true;q._changePageHandler(r,p);}else{if(r<h-1){m=true;q._changePageHandler(r+1,p);}}}else{m="false_end";}}else{m="false_end";for(var c in k){q=window.g_rptpage[c.toLowerCase()+"pagebar"];if(q){var r=q.paramobj.pageIndex;var h=q.paramobj.pageCount;if(i==="true"){r=0;m=true;q._gotoPage(r);}else{if(r<h-1){m=true;q._gotoPage(r+1);}}}else{continue;}}}}else{if(window.g_dsn){var f=window.g_dsn;var n=f.pagebarDiv;var q;if(n&&n.style.display!="none"){q=f.editor.olapeditor.pagebar;var a=q.paramobj;var r=a.pageIndex;var h=a.pageCount;var p=a.pageSize;if(i==="true"){r=0;m=true;q._changePageHandler(r,p);}else{if(r<h-1){m=true;q._changePageHandler(r+1,p);}}}b=window.g_rptId;}}if(window.g_formmgr){var j=window.g_formmgr.rpts;if(j){for(var c in j){var l=window.g_formmgr.rpts[c];if(l){var q=l.pageBar;if(q){var r=q.paramobj.pageIndex;var h=q.paramobj.pageCount;if(i==="true"){r=0;m=true;q._gotoPage(r);}else{if(r<h-1){m=true;q._gotoPage(r+1);}}}else{continue;}}}}}if(b){window.callPhantom("toNext_CallBack",m,b);}else{window.callPhantom("toNext_CallBack",m);}}catch(o){alert(o);}}function getBounds_CallBack(){try{var a=arguments[0].toString();if(a!=null){a=a.split(",");if(a.length>=4){setBounds(a);}}setTimeout(function(){var c=["false"];if(isFirstPage==="false"){c=["true"];evaluate("toNextPage_EBI",c);}else{if(isFirstPage==="true"){doScreenshot();evaluate("toNextPage_EBI",c);}}},1000);return;}catch(b){console.log(b);phantom.exit();}}function toNext_CallBack(){try{var b=arguments[0].toString();if(arguments[1]){var d=arguments[1].toString();}if(needInitPage==="true"&&isFirstPage==="false"){needInitPage=["false"];}if(b=="true"&&isFirstPage==="false"){var c=0;var a=setInterval(function(){c++;var e=page.evaluate(function(){return window.g_rptid;});if((e&&e!=d)||c==10){var g=setTimeout(function(){doScreenshot();evaluate("toNextPage_EBI",needInitPage);clearTimeout(g);},2000);clearInterval(a);}},1000);return;}else{if(objIndex>=screenshotObjs.length){if(b=="false_end"){doScreenshot();}phantom.exit();}else{currentId=screenshotObjs[objIndex++];evaluate("getBounds_EBI");}}}catch(f){console.log(f);phantom.exit();}}