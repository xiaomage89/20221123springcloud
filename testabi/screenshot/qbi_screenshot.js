function getBounds_QBI(){try{var i=arguments[0].toString();var p=arguments[1].toString();var l=arguments[2].toString();var a;var b=window.document.getElementById(i);if(b==null){a=[1,1,1,1];}else{var m=b.parentNode;var g=m.parentNode;var q=g.parentNode;var k=0;if(q.className.indexOf("layout_cell")==-1){m=g;g=g.parentNode;q=g.parentNode;k=k+31;}if(m.scrollHeight>m.offsetHeight){var g=m.parentNode;g.oldZIndex=g.style.zIndex;g.style.zIndex=2;q.oldHeight=q.offsetHeight;q.style.height=b.offsetHeight+k+parseInt(q.style.paddingBottom)+"px";q.oldtop=q.style.top;var n=b.getBoundingClientRect().top-m.getBoundingClientRect().top;m.scrollTop+=n;}if(p!="false"){if(l=="ppt"){if(!i.startsWith("QWidgetFilter")&&!i.startsWith("filterpanel")&&!i.startsWith("quicktab")){var f=window.document.getElementById("tomax");if(f){window.qlistener.getEditor().cmd_tomax(f,i);}}}else{var f=$(".tomax");if(f){window.qlistener.getEditor().cmd_tomax(f[0],i);}}}var j=b.getBoundingClientRect().top+1;var d=b.getBoundingClientRect().left+1;var c=b.offsetWidth-1;var o=b.offsetHeight-1;a=[j,d,c,o];}window.callPhantom("getBounds_CallBack",a.toString(),p,l);}catch(h){alert(h);}}function toNextPage_QBI(){try{var k=arguments[0];var l=k[0].toString();var c="false";var b=k[1];if(k[2]){c=k[2].toString();}var f=window;var i=f.qlistener.getEditor();while(!!i.getTempId()){break;}var g=false;var o;var d=null;var a=i.getWidget(l);if(typeof a=="undefined"){window.callPhantom("toNext_CallBack",g);return;}if(l=="editorview"){o=f.qlistener.getEditor().getWidget();d=a.getId();}else{if(a.getParentQWidget()){d=a.getParentQWidget().getOption("vqwid");}o=a.getChildNodes();}if(b==="false"){if(a.tagname=="QWidgetGrid"&&(d==a.getId()||a.getParentQWidget().getId()=="qboardarea")){var n=a.pagebar;if(n){if(c=="true"){n.first();g=true;}else{n.next();}if(n.cannext){g=true;}}}for(var p in o){var h=o[p];var m=h.getId();if(h.getParentQWidget()){m=h.getParentQWidget().getOption("vqwid");}if(h.tagname=="QWidgetGrid"&&(m==h.getId()||h.getParentQWidget().getId()=="qboardarea")){var n=h.pagebar;if(n){if(c=="true"){n.first();g=true;}else{n.next();}if(n.cannext){g=true;}}}}}window.callPhantom("toNext_CallBack",g);}catch(j){alert(j);}}function getBounds_CallBack(){var a=arguments[0];if(a!=null){a=a.toString().split(",");if(a.length>=4){setBounds(a);}}var b=setTimeout(function(){var c="false";if(isFirstPage==="false"){c="true";evaluate("toNextPage_QBI",currentId,isFirstPage,c);}else{doScreenshot();evaluate("toNextPage_QBI",currentId,isFirstPage,c);}clearTimeout(b);},1000);}function toNext_CallBack(){var a=arguments[0].toString();if(needInitPage==="true"&&isFirstPage==="false"){needInitPage="false";}var c=format==="pdf"&&a=="false"&&isFirstPage==="false"&&currentId!==window.oldId;if(a=="true"&&isFirstPage==="false"){window.oldId=currentId;var b=setTimeout(function(){doScreenshot();evaluate("toNextPage_QBI",currentId,isFirstPage,needInitPage);clearTimeout(b);},2000);}else{if(objIndex>=screenshotObjs.length){if(c){doScreenshot();}phantom.exit();}else{if(c){window.oldId=currentId;doScreenshot();}page.evaluate(function(e,g,i){var h=window.document.getElementById(e);var j=h.parentNode.parentNode;j.style.zIndex=j.oldZIndex;var d=j.parentNode;d.style.height=d.oldHeight+"px";d.style.top=d.oldtop;if(g!="false"){if(i=="ppt"){if(!e.startsWith("QWidgetFilter")&&!e.startsWith("filterpanel")&&!e.startsWith("quicktab")){var f=window.document.getElementById("tomax");if(f){window.qlistener.getEditor().cmd_tomax(f,e);}}}else{var f=$(".tonormal");if(f){window.qlistener.getEditor().cmd_tomax(f[0],e);}}}},currentId,zoom,format);currentId=screenshotObjs[objIndex++];page.evaluate(getBounds_QBI,currentId,zoom,format);}}}